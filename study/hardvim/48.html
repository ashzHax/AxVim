<!DOCTYPE html>
<!-- saved from url=(0063)https://learnvimscriptthehardway.stevelosh.com/chapters/48.html -->
<html lang="en"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        
        <title>Basic Folding / Learn Vimscript the Hard Way</title>
        <meta name="description" content="">
        <meta name="author" content="Steve Losh">
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

        <link href="./48_files/base.css" rel="stylesheet" type="text/css">
        <link href="./48_files/skeleton.css" rel="stylesheet" type="text/css">
        <link href="./48_files/layout.css" rel="stylesheet" type="text/css">

        <link href="./48_files/tango.css" rel="stylesheet" type="text/css">
        <link href="./48_files/style.less" rel="stylesheet/less" type="text/css">

        <script type="text/javascript" async="" id="gauges-tracker" data-site-id="4e8f83b7f5a1f546e200000d" src="./48_files/track.js"></script><script type="text/javascript" async="" src="./48_files/ga.js"></script><script type="text/javascript" src="./48_files/less.js"></script><style type="text/css" media="screen" id="less:static-styles-style">html {
  overflow-y: scroll;
}
html, body {
  font: normal 16px/22px 'Palatino', 'Georgia', sans-serif;
  color: #333;
}
html h1, body h1 {
  font-size: 28px;
}
html h2, body h2 {
  font-size: 22px;
}
html h3, body h3 {
  font-size: 20px;
}
html h4, body h4 {
  font-size: 18px;
}
html h5, body h5 {
  font-size: 16px;
}
html header, body header {
  margin-top: 30px;
  margin-bottom: 30px;
  text-align: center;
}
html header h1, body header h1 {
  font-size: 42px;
}
html header h1 a, body header h1 a {
  text-decoration: none;
}
html header h1 a:hover, body header h1 a:hover {
  text-decoration: underline;
}
html footer, body footer {
  margin-top: 30px;
  text-align: center;
  font-style: italic;
  margin-bottom: 100px;
}
html .toc ol, body .toc ol {
  margin-left: 0;
}
html .toc ol li, body .toc ol li {
  list-style: none;
}
html .nav, body .nav {
  margin-top: 18px;
}
html .nav ul, body .nav ul {
  list-style-type: none;
  font: inherit;
}
html .nav li, body .nav li {
  margin-left: 0px;
}
html .nav > ul > li > a, body .nav > ul > li > a {
  text-decoration: none;
  margin-bottom: 12px;
  font-weight: bold;
  font-size: 18px;
  display: block;
}
html .nav > ul > li > a:hover, body .nav > ul > li > a:hover {
  text-decoration: underline;
}
html .nav > ul > li > ul ul, body .nav > ul > li > ul ul {
  margin-left: 16px;
}
html .nav > ul > li > ul, body .nav > ul > li > ul {
  margin-left: 0px;
}
html .prevnext .next, body .prevnext .next {
  display: block;
  float: right;
}
html pre,
body pre,
html code,
body code {
  font: normal 14px Menlo, Monaco, Consolas, monospace;
  background-color: #fafafa;
  border: 1px solid #aaa;
}
html code, body code {
  padding: 0px 4px;
}
html pre, body pre {
  margin-bottom: 22px;
  padding: 6px 4px;
}
html pre code, body pre code {
  border: none;
  padding: 0;
}
html ul, body ul {
  list-style-type: circle;
}
html ul li, body ul li {
  margin-left: 36px;
  line-height: 22px;
}
body.splash section.toc {
  margin-top: 30px;
}
body.splash section.toc ol {
  margin-left: 26px;
}
body.splash section.toc ol.pre-toc {
  margin-bottom: 0px;
}
body.splash section.toc ol.pre-toc li {
  list-style-type: lower-roman;
}
body.splash section.toc ol.toc li {
  list-style-type: decimal;
}
</style>
    </head>

    <body class="" data-new-gr-c-s-check-loaded="14.1000.0" data-gr-ext-installed="">
        <div class="container">
            <header class="sixteen columns">
                <h1><a href="https://learnvimscriptthehardway.stevelosh.com/">Learn Vimscript the Hard Way</a></h1>
            </header>

            
    <section class="nav three columns">
        
<ul>
<li><a href="https://learnvimscriptthehardway.stevelosh.com/chapters/48.html#basic-folding">Basic Folding</a><ul>
<li><a href="https://learnvimscriptthehardway.stevelosh.com/chapters/48.html#types-of-folding">Types of Folding</a><ul>
<li><a href="https://learnvimscriptthehardway.stevelosh.com/chapters/48.html#manual">Manual</a></li>
<li><a href="https://learnvimscriptthehardway.stevelosh.com/chapters/48.html#marker">Marker</a></li>
<li><a href="https://learnvimscriptthehardway.stevelosh.com/chapters/48.html#diff">Diff</a></li>
<li><a href="https://learnvimscriptthehardway.stevelosh.com/chapters/48.html#expr">Expr</a></li>
<li><a href="https://learnvimscriptthehardway.stevelosh.com/chapters/48.html#indent">Indent</a></li>
</ul>
</li>
<li><a href="https://learnvimscriptthehardway.stevelosh.com/chapters/48.html#potion-folding">Potion Folding</a></li>
<li><a href="https://learnvimscriptthehardway.stevelosh.com/chapters/48.html#exercises">Exercises</a></li>
</ul>
</li>
</ul>


        <div class="prevnext">
            
                <a class="prev" href="https://learnvimscriptthehardway.stevelosh.com/chapters/47.html">« Prev</a>
            
            
                <a class="next" href="https://learnvimscriptthehardway.stevelosh.com/chapters/49.html">Next »</a>
            
        </div>
    </section>

    <section class="content twelve columns offset-by-one">
        <div> 
<h1 id="basic-folding">Basic Folding</h1>
<p>If you've never used code folding in Vim, you don't know what you're missing.
Read <code>:help usr_28</code> and spend some time playing around with it in your normal
work.  Come back to this chapter once you've got it in your fingers.</p>
<h2 id="types-of-folding">Types of Folding</h2>
<p>Vim supports six different ways of defining how your text should be folded.</p>
<h3 id="manual">Manual</h3>
<p>You create the folds by hand and they're stored in RAM by Vim.  When you close
Vim they go away and you have to recreate them the next time you edit the file.</p>
<p>This method can be handy if you combine it with some custom mappings to make it
easy to create folds.  We won't do that in this book, but keep it in the back
of your mind in case you run across a case where it could be handy.</p>
<h3 id="marker">Marker</h3>
<p>Vim folds your code based on characters in the actual text.</p>
<p>Usually these characters are put in comments (like <code>// {{{</code>), but in some
languages you can get away with using something in the language's syntax itself,
like <code>{</code> and <code>}</code> in Javascript files.</p>
<p>It may seem ugly to clutter up your code with comments that are purely for your
text editor, but the advantage is that it lets you hand-craft folds for
a specific file.  This can be really nice if you're working with a large file
that you want to organize in a very specific way.</p>
<h3 id="diff">Diff</h3>
<p>A special folding mode used when diff'ing files.  We won't talk about this one
at all because Vim automatically handles it.</p>
<h3 id="expr">Expr</h3>
<p>This lets you use a custom piece of Vimscript to define where folds occur.  It's
the most powerful method, but also requires the most work.  We'll talk about
this in the next chapter.</p>
<h3 id="indent">Indent</h3>
<p>Vim uses your code's indentation to determine folds.  Lines at the same
indentation level fold together, and lines with only whitespace (and blank
lines) are simply folded with their neighbors.</p>
<p>This is essentially free to use because your code is already indented; all you
have to do is turn it on.  This will be our first method of adding folding to
Potion files.</p>
<h2 id="potion-folding">Potion Folding</h2>
<p>Let's take a look at our sample Potion file once again:</p>
<pre class="codehilite"><code class="language-text">factorial = (n):
    total = 1
    n to 1 (i):
        total *= i.
    total.

10 times (i):
    i string print
    '! is: ' print
    factorial (i) string print
    "\n" print.</code></pre>


<p>The bodies of the function and loop are both indented.  This means we can get
some basic folding with very little effort by using indent folding.</p>
<p>Before we start, go ahead and add a comment above the <code>total *= i.</code> line so we
have a nice multiple-line inner block to test with.  You'll learn why we need to
do this when you do the exercises, but for now just trust me.  The file should
now look like this:</p>
<pre class="codehilite"><code class="language-text">factorial = (n):
    total = 1
    n to 1 (i):
        # Multiply the running total.
        total *= i.
    total.

10 times (i):
    i string print
    '! is: ' print
    factorial (i) string print
    "\n" print.</code></pre>


<p>Create an <code>ftplugin</code> folder in your Potion plugin's repository, and create
a <code>potion</code> folder inside that.  Finally, create a <code>folding.vim</code> file inside of
<em>that</em>.</p>
<p>Remember that Vim will run the code in this file whenever it sets a buffer's
<code>filetype</code> to <code>potion</code> (because it's in a folder named <code>potion</code>).</p>
<p>Putting all folding-related code into its own file is generally a good idea and
will help us keep the various functionality of our plugin organized.</p>
<p>Add the following line to this file:</p>
<pre class="codehilite"><code class="language-vim">setlocal foldmethod=indent</code></pre>


<p>Close Vim and open the <code>factorial.pn</code> file again.  Play around with the new
folding with <code>zR</code>, <code>zM</code>, and <code>za</code>.</p>
<p>One line of Vimscript gave us some useful folding!  That's pretty cool!</p>
<p>You might notice that the lines inside the inner loop of the <code>factorial</code>
function aren't folded even though they're indented.  What's going on?</p>
<p>It turns out that by default Vim will ignore lines beginning with a <code>#</code>
character when using <code>indent</code> folding.  This works great when editing C files
(where <code>#</code> signals a preprocessor directive) but isn't very helpful when you're
editing other types of files.</p>
<p>Let's add one more line to the <code>ftplugin/potion/folding.vim</code> file to fix this:</p>
<pre class="codehilite"><code class="language-vim">setlocal foldmethod=indent
setlocal foldignore=</code></pre>


<p>Close and reopen <code>factorial.pn</code> and now the inner block will be folded properly.</p>
<h2 id="exercises">Exercises</h2>
<p>Read <code>:help foldmethod</code>.</p>
<p>Read <code>:help fold-manual</code>.</p>
<p>Read <code>:help fold-marker</code> and <code>:help foldmarker</code>.</p>
<p>Read <code>:help fold-indent</code>.</p>
<p>Read <code>:help fdl</code> and <code>:help foldlevelstart</code>.</p>
<p>Read <code>:help foldminlines</code>.</p>
<p>Read <code>:help foldignore</code>.</p></div>

        <div class="prevnext">
            
                <a class="prev" href="https://learnvimscriptthehardway.stevelosh.com/chapters/47.html">« Previous</a>
            
            
                <a class="next" href="https://learnvimscriptthehardway.stevelosh.com/chapters/49.html">Next »</a>
            
        </div>
    </section>


            <footer class="sixteen columns">
                Made by <a href="http://stevelosh.com/">Steve Losh</a>.

                <a href="https://learnvimscriptthehardway.stevelosh.com/license.html">License</a>.

                Built with
                <a href="http://bitbucket.org/sjl/bookmarkdown/">Bookmarkdown</a>.
            </footer>
        </div>

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-15328874-8']);
                _gaq.push(['_trackPageview']);

                (function() {
                 var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                 ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                 var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                 })();
            </script>
        

        
            <script type="text/javascript">
                var _gauges = _gauges || [];
                (function() {
                 var t   = document.createElement('script');
                 t.type  = 'text/javascript';
                 t.async = true;
                 t.id    = 'gauges-tracker';
                 t.setAttribute('data-site-id', '4e8f83b7f5a1f546e200000d');
                 t.src = '//secure.gaug.es/track.js';
                 var s = document.getElementsByTagName('script')[0];
                 s.parentNode.insertBefore(t, s);
                 })();
             </script>
        
    
</body></html>